<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science for Petroleum Production Engineers</title>
  <meta name="description" content="This is the start of the book of a simple data science book.">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science for Petroleum Production Engineers" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the start of the book of a simple data science book." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science for Petroleum Production Engineers" />
  
  <meta name="twitter:description" content="This is the start of the book of a simple data science book." />
  

<meta name="author" content="Alfonso R. Reyes">


<meta name="date" content="2017-06-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="dsp2e-the-well-network-dataset-part-3.html">
<link rel="next" href="gathering-auxiliary-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Zero Draft Book </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-science-for-petroleum-production-engineering-part-1.html"><a href="data-science-for-petroleum-production-engineering-part-1.html"><i class="fa fa-check"></i><b>1</b> Data Science for Petroleum Production Engineering (part 1)</a></li>
<li class="chapter" data-level="2" data-path="dsppe-acquiring-the-data-part-2.html"><a href="dsppe-acquiring-the-data-part-2.html"><i class="fa fa-check"></i><b>2</b> DSPPE - Acquiring the Data (part 2)</a></li>
<li class="chapter" data-level="3" data-path="dsp2e-the-well-network-dataset-part-3.html"><a href="dsp2e-the-well-network-dataset-part-3.html"><i class="fa fa-check"></i><b>3</b> <span class="math inline">\(DSP^2E\)</span> - The Well Network Dataset (part 3)</a></li>
<li class="chapter" data-level="4" data-path="the-network-model.html"><a href="the-network-model.html"><i class="fa fa-check"></i><b>4</b> The Network Model</a><ul>
<li class="chapter" data-level="4.1" data-path="the-network-model.html"><a href="the-network-model.html#the-need-of-automation-for-well-network-modeling"><i class="fa fa-check"></i><b>4.1</b> The need of automation for well network modeling</a></li>
<li class="chapter" data-level="4.2" data-path="the-network-model.html"><a href="the-network-model.html#the-network-model-dataset"><i class="fa fa-check"></i><b>4.2</b> The network model dataset</a></li>
<li class="chapter" data-level="4.3" data-path="the-network-model.html"><a href="the-network-model.html#reading-the-model-variables-with-automation"><i class="fa fa-check"></i><b>4.3</b> Reading the model variables with automation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gathering-auxiliary-data.html"><a href="gathering-auxiliary-data.html"><i class="fa fa-check"></i><b>5</b> Gathering auxiliary data</a><ul>
<li class="chapter" data-level="5.1" data-path="gathering-auxiliary-data.html"><a href="gathering-auxiliary-data.html#the-field-view"><i class="fa fa-check"></i><b>5.1</b> The field view</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-kpis-dataset-for-gas-lift.html"><a href="the-kpis-dataset-for-gas-lift.html"><i class="fa fa-check"></i><b>6</b> The KPIs dataset for Gas Lift</a><ul>
<li class="chapter" data-level="6.1" data-path="the-kpis-dataset-for-gas-lift.html"><a href="the-kpis-dataset-for-gas-lift.html#other-datasets"><i class="fa fa-check"></i><b>6.1</b> Other datasets</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>7</b> Basic statistics</a></li>
<li class="chapter" data-level="8" data-path="advanced-statistics.html"><a href="advanced-statistics.html"><i class="fa fa-check"></i><b>8</b> Advanced statistics</a></li>
<li class="chapter" data-level="9" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>9</b> Conclusions</a></li>
<li class="chapter" data-level="10" data-path="r-and-the-search-of-the-ideal-language-for-petroleum-engineering.html"><a href="r-and-the-search-of-the-ideal-language-for-petroleum-engineering.html"><i class="fa fa-check"></i><b>10</b> “R” and the search of the ideal language for petroleum engineering</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Petroleum Production Engineers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-network-model" class="section level1">
<h1><span class="header-section-number">4</span> The Network Model</h1>
<div id="the-need-of-automation-for-well-network-modeling" class="section level2">
<h2><span class="header-section-number">4.1</span> The need of automation for well network modeling</h2>
<p>As we mentioned above, the export format of the calculation results of network modeling for well optimization is <strong>non-structured</strong> text but still it can be printed or pasted directly to Excel for parsing to separate the data in columns (<strong>variables</strong>) and rows (<strong>observations</strong>). In some way, this is time consuming and a potential source of errors. Worse if several iterations have to be performed on the well and network input data for the generation of <strong>optimization</strong> <strong>scenarios</strong>. Certainly, this process is screaming to be automated. But that takes time and resources.</p>
<p>This is what this is about: generating a repeatable and automated script to read the network model from the original source or calculation engine: GAP. GAP is a comprehensive application from Petroleum Experts to resolve well networks. It is unique in the sense that counts with a very powerful interface for data interchange with other applications; it is called <strong>OpenServer</strong>.</p>
<p>With OpenServer it is possible to read and write variables from and to the network model. Also allows the production engineer to customize production <strong>optimization scenarios</strong> in the most complex fashion making possible an automated process by means of iterative input to find a solution that better adapts to the conditions of our field. In this article we dedicate our attention to the GAP Solver that looks like Figure 1. It corresponds to a generic example.</p>
<p>￼<img src="images/solver_details.png" />] <em>Figure 1 - GAP solver panel from one of the examples.</em></p>
</div>
<div id="the-network-model-dataset" class="section level2">
<h2><span class="header-section-number">4.2</span> The network model dataset</h2>
<p>The well network dataset is formed essentially by the columns in the solver. In the figure above you see on the first column various items that are part of the network such as flowlines, separators, joints, etc., but we are looking for is only the wells. Of course, you can analyze other network components but that could be a topic of a different article. Each of the columns in the table can be extracted, as we explained above, by copy-pasting to Excel, or by using OpenServer. We read each of the columns (the ones that we are most interested in) and create a dataset. We will explain later how this reading process works (involves Python and OpenServer).</p>
<ul>
<li>[ ] <code>show obfuscated datase/table/dataframe</code></li>
</ul>
<p>The rows in the dataset correspond to the wells and the columns to the variables that were extracted from the columns in the solver.</p>
<p>Instinctively, we may tempted to say, after seeing the solver table, that the dataset should be just the calculated columns in that table. But that would be an incomplete dataset. Besides of the solution for the scenario proposed, we require additional data for the network of wells under analysis.</p>
<p>-[ ] <code>what is the additional data?</code></p>
</div>
<div id="reading-the-model-variables-with-automation" class="section level2">
<h2><span class="header-section-number">4.3</span> Reading the model variables with automation</h2>
<p>Reading the GAP model requires a connection to OpenServer through a COM server. There are few examples under the OpenServer folder in the IPM examples installation folder that uses Excel VBA. For simple examples, Excel is fine. For serious programming and more complex tasks it is recommended to use Python or other high level language.</p>
<p>We show below a pseudo-code explaining the steps for reading GAP variables. Writing to GAP is similar.</p>
<ul>
<li>[ ] <code>explain the GAP variable</code></li>
<li>[ ] <code>show few examples of the variables: GAP.well[0].bla-bla-bla</code></li>
<li>[ ] <code>show a basic code to read the variables to a dataframe. Pseudo-code</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># pseudo-code for GAP automation script with Python</span>
<span class="im">from</span> ptech <span class="im">import</span> <span class="op">*</span>

connect_to_openserver()
start_gap()

select_network_model()
open_network_model()

wells <span class="op">=</span> NetworkModel(wells)

data <span class="op">=</span> <span class="bu">list</span>()
<span class="cf">for</span> well <span class="op">in</span> wells:
    data.append(read_variables(well))
    
create_dataframe(data)
shutdown_gap()
close_openserver()</code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dsp2e-the-well-network-dataset-part-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gathering-auxiliary-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/p3_ds_for_ppe.Rmd",
"text": "Edit"
},
"download": ["data_science_ptech.pdf", "data_science_ptech.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
